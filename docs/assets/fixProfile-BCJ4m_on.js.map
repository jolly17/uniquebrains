{"version":3,"file":"fixProfile-BCJ4m_on.js","sources":["../../src/utils/fixProfile.js"],"sourcesContent":["import { supabase } from '../lib/supabase'\r\n\r\n/**\r\n * Debug function to check and fix user profile role\r\n * Use this to manually fix role assignment issues\r\n */\r\nexport async function checkAndFixProfile(userId, correctRole = 'parent') {\r\n  try {\r\n    console.log('üîç Checking profile for user:', userId)\r\n    \r\n    // Get current profile\r\n    const { data: profile, error: fetchError } = await supabase\r\n      .from('profiles')\r\n      .select('*')\r\n      .eq('id', userId)\r\n      .single()\r\n\r\n    if (fetchError) {\r\n      console.error('‚ùå Error fetching profile:', fetchError)\r\n      return { success: false, error: fetchError }\r\n    }\r\n\r\n    console.log('üìã Current profile:', profile)\r\n\r\n    // Check if role needs fixing\r\n    if (profile.role !== correctRole) {\r\n      console.log(`üîß Fixing role from '${profile.role}' to '${correctRole}'`)\r\n      \r\n      const { error: updateError } = await supabase\r\n        .from('profiles')\r\n        .update({ role: correctRole })\r\n        .eq('id', userId)\r\n\r\n      if (updateError) {\r\n        console.error('‚ùå Error updating role:', updateError)\r\n        return { success: false, error: updateError }\r\n      }\r\n\r\n      console.log('‚úÖ Role updated successfully!')\r\n      return { success: true, updated: true, oldRole: profile.role, newRole: correctRole }\r\n    } else {\r\n      console.log('‚úÖ Role is already correct')\r\n      return { success: true, updated: false, role: profile.role }\r\n    }\r\n  } catch (error) {\r\n    console.error('‚ùå Unexpected error:', error)\r\n    return { success: false, error }\r\n  }\r\n}\r\n\r\n/**\r\n * Debug function to list all profiles and their roles\r\n */\r\nexport async function listAllProfiles() {\r\n  try {\r\n    const { data: profiles, error } = await supabase\r\n      .from('profiles')\r\n      .select('id, email, first_name, last_name, role, created_at')\r\n      .order('created_at', { ascending: false })\r\n\r\n    if (error) {\r\n      console.error('‚ùå Error fetching profiles:', error)\r\n      return\r\n    }\r\n\r\n    console.log('üìã All profiles:')\r\n    console.table(profiles)\r\n    return profiles\r\n  } catch (error) {\r\n    console.error('‚ùå Unexpected error:', error)\r\n  }\r\n}\r\n\r\n// Make functions available globally for debugging\r\nif (typeof window !== 'undefined') {\r\n  window.checkAndFixProfile = checkAndFixProfile\r\n  window.listAllProfiles = listAllProfiles\r\n}"],"names":["checkAndFixProfile","userId","correctRole","profile","fetchError","supabase","updateError","error","listAllProfiles","profiles"],"mappings":"ghBAMO,eAAeA,EAAmBC,EAAQC,EAAc,SAAU,CACvE,GAAI,CACF,QAAQ,IAAI,gCAAiCD,CAAM,EAGnD,KAAM,CAAE,KAAME,EAAS,MAAOC,CAAU,EAAK,MAAMC,EAChD,KAAK,UAAU,EACf,OAAO,GAAG,EACV,GAAG,KAAMJ,CAAM,EACf,OAAM,EAET,GAAIG,EACF,eAAQ,MAAM,4BAA6BA,CAAU,EAC9C,CAAE,QAAS,GAAO,MAAOA,CAAU,EAM5C,GAHA,QAAQ,IAAI,sBAAuBD,CAAO,EAGtCA,EAAQ,OAASD,EAAa,CAChC,QAAQ,IAAI,wBAAwBC,EAAQ,IAAI,SAASD,CAAW,GAAG,EAEvE,KAAM,CAAE,MAAOI,CAAW,EAAK,MAAMD,EAClC,KAAK,UAAU,EACf,OAAO,CAAE,KAAMH,EAAa,EAC5B,GAAG,KAAMD,CAAM,EAElB,OAAIK,GACF,QAAQ,MAAM,yBAA0BA,CAAW,EAC5C,CAAE,QAAS,GAAO,MAAOA,CAAW,IAG7C,QAAQ,IAAI,8BAA8B,EACnC,CAAE,QAAS,GAAM,QAAS,GAAM,QAASH,EAAQ,KAAM,QAASD,CAAW,EACpF,KACE,gBAAQ,IAAI,2BAA2B,EAChC,CAAE,QAAS,GAAM,QAAS,GAAO,KAAMC,EAAQ,IAAI,CAE9D,OAASI,EAAO,CACd,eAAQ,MAAM,sBAAuBA,CAAK,EACnC,CAAE,QAAS,GAAO,MAAAA,CAAK,CAChC,CACF,CAKO,eAAeC,GAAkB,CACtC,GAAI,CACF,KAAM,CAAE,KAAMC,EAAU,MAAAF,CAAK,EAAK,MAAMF,EACrC,KAAK,UAAU,EACf,OAAO,oDAAoD,EAC3D,MAAM,aAAc,CAAE,UAAW,EAAK,CAAE,EAE3C,GAAIE,EAAO,CACT,QAAQ,MAAM,6BAA8BA,CAAK,EACjD,MACF,CAEA,eAAQ,IAAI,kBAAkB,EAC9B,QAAQ,MAAME,CAAQ,EACfA,CACT,OAASF,EAAO,CACd,QAAQ,MAAM,sBAAuBA,CAAK,CAC5C,CACF,CAGI,OAAO,OAAW,MACpB,OAAO,mBAAqBP,EAC5B,OAAO,gBAAkBQ"}